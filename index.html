<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <title>Fragebogen (15 Fragen, Mix aus Tiermetaphern)</title>
  
  <!-- Chart.js f√ºr die Diagramme -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  
  <!-- html2canvas f√ºr Screenshots -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
  
  <!-- html2pdf.js (inklusive jsPDF & html2canvas) f√ºr PDF-Export -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
  
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0 auto;
      max-width: 900px;
      background: #f7f9fc;
      padding: 20px;
      color: #333;
    }
    h1 {
      text-align: center;
      color: #1a73e8;
      margin-bottom: 5px;
    }
    p.beschreibung {
      text-align: center;
      margin-top: 0;
      font-size: 0.95em;
      color: #555;
    }
    .frage-box {
      background: #fff;
      margin: 20px 0;
      padding: 15px;
      border-radius: 8px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }
    .frage-box h2 {
      font-size: 1.1em;
      margin-top: 0;
    }
    .skala-antwort {
      margin-left: 20px;
      margin-top: 5px;
    }
    .skala-antwort label {
      display: inline-block;
      margin-right: 10px;
      cursor: pointer;
    }
    button {
      display: block;
      margin: 20px auto;
      padding: 12px 20px;
      background-color: #4caf50;
      color: white;
      border: none;
      border-radius: 4px;
      font-size: 16px;
      cursor: pointer;
    }
    button:hover {
      background-color: #45a049;
    }
    #ergebnis {
      background: #fff;
      margin-top: 20px;
      padding: 15px;
      border-radius: 8px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }
    #ergebnis h2 {
      margin-top: 0;
    }
    .tier-block {
      margin: 10px 0;
      padding: 10px;
      border-radius: 6px;
      background: #f0f0f0;
    }
    .ergebnis-erklaerung {
      margin-top: 20px;
      font-size: 0.95em;
      color: #555;
      /* Verhindert Seitenumbr√ºche innerhalb des Blocks */
      page-break-inside: avoid;
    }
    #chart {
      display: block;
      max-width: 600px;
      margin: 20px auto;
    }
  </style>
</head>
<body>

<h1>Dein Fragebogen</h1>
<p class="beschreibung">
  W√§hle f√ºr jede Aussage eine Zahl von 0 bis 4,<br>
  wobei 0 gar nicht zutrifft und 4 v√∂llig zutrifft.
</p>

<form id="fragebogen"></form>
<button form="fragebogen" type="submit">Auswerten</button>

<!-- Ergebnis-Bereich -->
<div id="ergebnis"></div>

<!-- PDF-Button -->
<button id="pdfButton">üìÑ Als PDF speichern</button>

<canvas id="chart"></canvas>

<script>
// =====================================================
// 1) FRAGEN (15 St√ºck) ‚Äì Formular
// =====================================================
var questions = [
  {
    frage: "Frage 1: Wie setzt du deine F√§higkeiten in einem Team am liebsten ein?",
    answers: {
      A: { code: "S1", text: "Ich √ºbernehme gerne Verantwortung, koordiniere Aufgaben und achte auf den Gesamt√ºberblick." },
      B: { code: "S2", text: "Ich arbeite strukturiert, gehe Schritt f√ºr Schritt vor und bleibe bei erprobten Methoden." },
      C: { code: "R1", text: "Ich halte auch unter Druck durch, bleibe ausdauernd und verliere mein Ziel nicht aus den Augen." },
      D: { code: "R2", text: "Ich reagiere flexibel, probiere neue Ans√§tze aus und bleibe offen f√ºr √Ñnderungen." }
    }
  },
  {
    frage: "Frage 2: Wie verh√§ltst du dich, wenn im Team Konflikte auftreten?",
    answers: {
      A: { code: "S3", text: "Ich suche das direkte Gespr√§ch, h√∂re alle Seiten an und strebe eine gemeinsame L√∂sung an." },
      B: { code: "S4", text: "Ich versuche, mich anzupassen oder zu vermitteln, damit der Konflikt schnell entsch√§rft wird." },
      C: { code: "R3", text: "Ich stelle provozierende Fragen, um festgefahrene Denkblockaden aufzubrechen ‚Äì auch wenn das aneckt." },
      D: { code: "R4", text: "Ich bleibe ruhig, vermeide vorschnelle Urteile und vermittle Stabilit√§t in der Gruppe." }
    }
  },
  {
    frage: "Frage 3: Was motiviert dich, deine Arbeit mit vollem Einsatz zu erledigen?",
    answers: {
      A: { code: "S5", text: "Grosse Herausforderungen, bei denen ich meine Kraft und Ausdauer zeigen kann." },
      B: { code: "S6", text: "Inspirierende Visionen und die Hoffnung, etwas Sinnvolles oder Kreatives beizutragen." },
      C: { code: "R5", text: "Die Chance, strategisch vorzugehen, clevere L√∂sungen zu finden und Chancen zu erkennen." },
      D: { code: "R6", text: "Ein dynamisches Umfeld, in dem ich schnell reagieren und sofort anpacken kann." }
    }
  },
  {
    frage: "Frage 4: Wie gehst du mit unerwarteten Ver√§nderungen im Arbeitsablauf um?",
    answers: {
      A: { code: "S7", text: "Ich bleibe ruhig, passe mich an, sobald ich die neue Situation verstehe." },
      B: { code: "S8", text: "Ich analysiere gr√ºndlich, schaue mir Risiken und Chancen an, bevor ich handle." },
      C: { code: "R7", text: "Ich ziehe mich etwas zur√ºck, gehe schrittweise vor und vermeide √ºbereilte Entschl√ºsse." },
      D: { code: "R8", text: "Ich √ºbernehme spontan Verantwortung und greife schnell ein, wenn ich eine M√∂glichkeit sehe." }
    }
  },
  {
    frage: "Frage 5: Welche Aspekte sind dir in einem Arbeitsumfeld besonders wichtig?",
    answers: {
      A: { code: "S9", text: "Besonnene, eher langsame Entscheidungen, damit nichts √ºberst√ºrzt wird." },
      B: { code: "S10", text: "Strategisches und innovatives Denken, um Neues zu entwickeln." },
      C: { code: "R11", text: "Provokante Impulse, die eingefahrene Routinen aufbrechen ‚Äì auch wenn das andere als aufdringlich empfunden wird." },
      D: { code: "R12", text: "Effizienz und Zuverl√§ssigkeit, damit das Team ein klares Ziel im Auge beh√§lt." }
    }
  },
  {
    frage: "Frage 6: Wie triffst du pers√∂nlich Entscheidungen in unsicheren Situationen?",
    answers: {
      A: { code: "S11", text: "Ich beziehe gern mein Umfeld ein, diskutiere mit dem Team und suche einen Konsens." },
      B: { code: "S12", text: "Ich setze auf Bew√§hrtes, bleibe loyal gegen√ºber bestehenden Strukturen und gehe ungern Risiken ein." },
      C: { code: "R9", text: "Ich handle schnell und entschlossen, ohne mich lange von Unsicherheiten aufhalten zu lassen." },
      D: { code: "R10", text: "Ich folge meinem Bauchgef√ºhl und bin offen f√ºr spontane Ideen, auch wenn sie ungew√∂hnlich sind." }
    }
  },
  {
    frage: "Frage 7: Welche Rolle spielt Unabh√§ngigkeit in deinem Arbeitsalltag?",
    answers: {
      A: { code: "S13", text: "Ich halte mich f√ºr √§usserst vielseitig und kreativ, manchmal √ºbersch√§tze ich dabei meine M√∂glichkeiten." },
      B: { code: "S14", text: "Ich finde Durchsetzungsf√§higkeit entscheidend, um eigenst√§ndig handeln zu k√∂nnen." },
      C: { code: "R15", text: "Teamgeist geht vor; ich lege grossen Wert auf Austausch und ein starkes Gemeinschaftsgef√ºhl." },
      D: { code: "R16", text: "Mir ist eine reibungslose Kommunikation besonders wichtig, damit alle an einem Strang ziehen." }
    }
  },
  {
    frage: "Frage 8: Wie stehst du zu Verantwortung im Job?",
    answers: {
      A: { code: "S15", text: "Ich √ºbernehme Verantwortung eher unterst√ºtzend, sorge f√ºr Effizienz und helfe dem Team, ohne im Rampenlicht zu stehen." },
      B: { code: "S16", text: "Ich setze konsequent meine eigenen Ideen durch, selbst wenn das Team das als eigenwillig oder st√∂rend empfindet." },
      C: { code: "R13", text: "Ich nutze Verantwortung strategisch und scheue mich nicht, nachdr√ºcklich zu handeln, wenn es meinen Zielen dient." },
      D: { code: "R14", text: "Ich kombiniere viele F√§higkeiten und bin √ºberzeugt, fast alles l√∂sen zu k√∂nnen, was teils √ºberheblich wirkt." }
    }
  },
  {
    frage: "Frage 9: Wie reagierst du, wenn du kritisiert wirst?",
    answers: {
      A: { code: "S17", text: "Ich bin offen daf√ºr, reflektiere mein Verhalten und passe mich an, wenn es sinnvoll ist." },
      B: { code: "S18", text: "Ich halte an meinem Standpunkt fest und lasse mich nicht schnell verunsichern." },
      C: { code: "R19", text: "Ich denke ausgiebig nach und ziehe meine Lehren aus konstruktiver Kritik." },
      D: { code: "R20", text: "Ich bleibe gefasst und nutze Feedback als Chance zur Weiterentwicklung." }
    }
  },
  {
    frage: "Frage 10: Welche Rolle nimmst du typischerweise in einem Team ein?",
    answers: {
      A: { code: "S19", text: "Ich √ºbernehme gerne F√ºhrung, bin mutig und gehe voran." },
      B: { code: "S20", text: "Ich arbeite gr√ºndlich, k√ºmmere mich um Details und gebe dem Team R√ºckhalt." },
      C: { code: "R21", text: "Ich bringe vision√§re Ideen ein, wirke jedoch manchmal z√∂gerlich oder unsicher, wenn es an die Umsetzung geht." },
      D: { code: "R22", text: "Ich bin energiegeladen, packe Herausforderungen direkt an und bleibe entschlossen." }
    }
  },
  {
    frage: "Frage 11: Wie gestaltest du deine langfristige Planung?",
    answers: {
      A: { code: "S21", text: "Ich investiere viel Energie und nutze jede Gelegenheit, notfalls auch manipulativ, um voranzukommen." },
      B: { code: "S22", text: "Ich passe meine Pl√§ne flexibel an, behalte aber mein Hauptziel stets im Blick." },
      C: { code: "R17", text: "Ich wahre den √úberblick, formuliere klare Visionen und verfolge sie konsequent." },
      D: { code: "R18", text: "Ich bleibe besonnen und bedacht, lasse mich auch durch Stress nicht aus der Ruhe bringen." }
    }
  },
  {
    frage: "Frage 12: Wie reagierst du auf hohen Zeit- oder Leistungsdruck?",
    answers: {
      A: { code: "S23", text: "Ich strahle Ruhe aus, strukturiere meine Aufgaben und lasse mich nicht hetzen." },
      B: { code: "S24", text: "Ich werde sogar kreativer, wenn es turbulent wird, und passe meine Vorgehensweise flexibel an." },
      C: { code: "R25", text: "Ich gehe systematisch vor, um Fehler zu vermeiden und den √úberblick zu behalten." },
      D: { code: "R26", text: "Ich ziehe das Tempo an, bleibe fokussiert und m√∂chte H√∂chstleistung zeigen." }
    }
  },
  {
    frage: "Frage 13: Welche besondere St√§rke bringst du verl√§sslich in dein Berufsleben ein?",
    answers: {
      A: { code: "S25", text: "Ich unterst√ºtze das Team mit zuverl√§ssiger Arbeit und finde oft originelle L√∂sungsans√§tze." },
      B: { code: "S26", text: "Ich bin robust, halte lange durch und scheue keine grossen Herausforderungen." },
      C: { code: "R23", text: "Ich bin flexibel, denke schnell um und kann mich rasch auf Ver√§nderungen einstellen." },
      D: { code: "R24", text: "Ich bin kooperativ, entwickle neue Ideen und f√∂rdere den Zusammenhalt im Team." }
    }
  },
  {
    frage: "Frage 14: Welche St√§rken beschreiben dich am besten (Mix‚ÄêFrage)?",
    answers: {
      A: { code: "C1", text: "Fleiss, Flexibilit√§t, Eleganz, vision√§res Denken (vereint mehrere Eigenschaften)." },
      B: { code: "C2", text: "Robust, unabh√§ngig, zupackend, meistert grosse Herausforderungen." },
      C: { code: "C3", text: "Gelassen, bed√§chtig, weise, strategisch ‚Äì oft mit ruhiger Energie." },
      D: { code: "C4", text: "Manchmal provokant, loyal, spontan, ideenreich in neuen Situationen." }
    }
  },
  {
    frage: "Frage 15: In welchem Bereich m√∂chtest du dich pers√∂nlich weiterentwickeln?",
    answers: {
      A: { code: "C1", text: "Ich m√∂chte lernen, nicht immer alles kontrollieren zu wollen und auch loszulassen." },
      B: { code: "C2", text: "Ich will bewusster mit impulsiven Reaktionen umgehen und mehr Geduld entwickeln." },
      C: { code: "C3", text: "Ich arbeite daran, Entscheidungen mutiger zu treffen und nicht zu lange zu gr√ºbeln." },
      D: { code: "C4", text: "Ich m√∂chte meine Spontanit√§t besser strukturieren und emotionale Ausbr√ºche im Zaum halten." }
    }
  }
];

// =====================================================
// 2) CODE -> TIER
// =====================================================
var codeToTier = {
  S1: "Adler",   S2: "Ameise",   R1: "Yak",     R2: "Katze",
  S3: "Biene",   S4: "Cham√§leon",R3: "Parasit", R4: "Wal",
  S5: "Dinosaurier", S6: "Einhorn", R5: "Schakal", R6: "Piranha",
  S7: "Eiche",   S8: "Eule",     R7: "Maus",    R8: "L√∂we",
  S9: "Faultier",S10: "Geier",   R11: "Insekt (l√§stig)", R12: "Insekt (n√ºtzlich)",
  S11: "Gibbon", S12: "Hund",    R9: "Klapperschlange", R10: "Kind",
  S13: "Hybrid", S14: "Hy√§ne",   R15: "Hund",   R16: "Gibbon",
  S15: "Insekt (n√ºtzlich)", S16: "Insekt (l√§stig)", R13: "Hy√§ne", R14: "Hybrid",
  S17: "Kind",   S18: "Klapperschlange", R19: "Eule", R20: "Eiche",
  S19: "L√∂we",   S20: "Maus",    R21: "Einhorn", R22: "Dinosaurier",
  S21: "Piranha",S22: "Schakal", R17: "Geier",  R18: "Faultier",
  S23: "Wal",    S24: "Parasit", R25: "Ameise", R26: "Adler",
  S25: "Katze",  S26: "Yak",     R23: "Cham√§leon", R24: "Biene"
};

// =====================================================
// 2a) Antwortkombinationen (Frage 14 und 15)
// =====================================================
var comboMapping = {
  C1: ["Adler","Ameise","Biene","Cham√§leon","Wal","Einhorn"],
  C2: ["Yak","Katze","Parasit","Dinosaurier","Schakal","Piranha"],
  C3: ["Eiche","Eule","Maus","L√∂we","Faultier","Geier","Hybrid"],
  C4: ["Insekt (l√§stig)","Insekt (n√ºtzlich)","Klapperschlange","Kind","Hy√§ne","Hund","Gibbon"]
};

// =====================================================
// 3) TIER-BESCHREIBUNGEN
// =====================================================
var tierTexte = {
  "Ameise": { kurz: "üêú Organisiert, teamorientiert, methodisch", symbolischF√ºr: "Teamgeist" },
  "Biene": { kurz: "üêù Fleissig, verantwortungsbewusst, anpassungsf√§hig", symbolischF√ºr: "Zusammenhalt" },
  "Cham√§leon": { kurz: "ü¶é Anpassungsf√§hig, vision√§r, teils manipulativ", symbolischF√ºr: "Wandlungsf√§higkeit" },
  "Hund": { kurz: "üêï Begeistert, emotional, offen", symbolischF√ºr: "Treue" },
  "Adler": { kurz: "ü¶Ö Intuitiv, strategisch, wetteifernd", symbolischF√ºr: "Weitblick" },
  "Katze": { kurz: "üêà Denkend, unabh√§ngig, rebellisch", symbolischF√ºr: "Freiheit" },
  "Gibbon": { kurz: "üêí Kontaktfreudig, reflektierend, teils distanziert", symbolischF√ºr: "Kommunikation" },
  "Hy√§ne": { kurz: "ü¶ù Strategisch, ehrgeizig, aggressiv", symbolischF√ºr: "Zielstrebigkeit" },
  "Insekt (n√ºtzlich)": { kurz: "üêû Unterst√ºtzend, einfallsreich, positiv", symbolischF√ºr: "N√ºtzlichkeit" },
  "Insekt (l√§stig)": { kurz: "üêû Eigensinnig, unberechenbar, oft st√∂rend", symbolischF√ºr: "Hartn√§ckigkeit" },
  "Schakal": { kurz: "ü¶ä Individualistisch, aggressiv, rebellisch", symbolischF√ºr: "Unabh√§ngigkeit" },
  "L√∂we": { kurz: "ü¶Å Intuitiv, machtbewusst, strategisch", symbolischF√ºr: "Kraft" },
  "Maus": { kurz: "üêÅ Denkend, vorsichtig, zuverl√§ssig", symbolischF√ºr: "Sicherheit" },
  "Parasit": { kurz: "ü™± Unsichtbar, manipulativ, anpassungsf√§hig", symbolischF√ºr: "Tarnung" },
  "Eule": { kurz: "ü¶â Weise, logisch, reflektierend", symbolischF√ºr: "Weisheit" },
  "Piranha": { kurz: "üêü Gef√§hrlich, handlungsorientiert, manipulativ", symbolischF√ºr: "Aggression" },
  "Eiche": { kurz: "üå≥ Stark, produktiv, inspirierend", symbolischF√ºr: "Stabilit√§t" },
  "Klapperschlange": { kurz: "üêç Gef√§hrlich, intelligent, gerissen", symbolischF√ºr: "Gerissenheit" },
  "Faultier": { kurz: "ü¶• Geduldig, bescheiden, langsam", symbolischF√ºr: "Gelassenheit" },
  "Dinosaurier": { kurz: "ü¶ñ Stark, distanziert, zur√ºckgezogen", symbolischF√ºr: "Uralte Macht" },
  "Einhorn": { kurz: "ü¶Ñ Vision√§r, anpassungsf√§hig, naiv", symbolischF√ºr: "Tr√§umerei" },
  "Geier": { kurz: "ü¶Ö Vorausschauend, intuitiv, wenig loyal", symbolischF√ºr: "Opportunismus" },
  "Wal": { kurz: "üêã Vertrauensw√ºrdig, stark, emotional", symbolischF√ºr: "Tiefe" },
  "Hybrid": { kurz: "üîÄ Intelligent, anpassungsf√§hig, distanziert", symbolischF√ºr: "Universalit√§t" },
  "Yak": { kurz: "üêÇ Robust, bescheiden, strategisch", symbolischF√ºr: "Ausdauer" },
  "Kind": { kurz: "üë∂ Begeistert, inspirierend, emotional", symbolischF√ºr: "Unbeschwertheit" }
};

// =====================================================
// 3a) Gegenspieler-Logik (f√ºr St√§rkekonflikt)
// =====================================================
var gegenspieler = {
  "Adler": "Kind",
  "Kind": "Adler",

  "Ameise": "Hybrid",
  "Hybrid": "Ameise",

  "Biene": "Hy√§ne",
  "Hy√§ne": "Biene",

  "Cham√§leon": "Eule",
  "Eule": "Cham√§leon",

  "Hund": "Katze",
  "Katze": "Hund",

  "Gibbon": "Parasit",
  "Parasit": "Gibbon",

  "L√∂we": "Maus",
  "Maus": "L√∂we",

  "Wal": "Schakal",
  "Schakal": "Wal",

  "Insekt (n√ºtzlich)": "Insekt (l√§stig)",
  "Insekt (l√§stig)": "Insekt (n√ºtzlich)",

  "Piranha": "Faultier",
  "Faultier": "Piranha",

  "Einhorn": "Geier",
  "Geier": "Einhorn",

  "Eiche": "Klapperschlange",
  "Klapperschlange": "Eiche",

  "Yak": "Dinosaurier",
  "Dinosaurier": "Yak"
};

// =====================================================
// (Optional) Konflikt-Texte ‚Äì jeweils 2 pro Tier, neutral formuliert
// =====================================================
var tierKonflikte = {
  "Adler": {
    "Kind": "Zwischen Adler und Kind k√∂nnen Spannungen entstehen, da der strategische Adler einen klaren Plan verfolgt, w√§hrend das Kind impulsiv agiert.",
    "Wal": "Adler und Wal k√∂nnen unterschiedliche Arbeitsrhythmen haben ‚Äì Adler strebt nach Schnelligkeit, Wal setzt auf Ruhe."
  },
  "Ameise": {
    "Piranha": "Ameise und Piranha zeigen unterschiedliche Herangehensweisen: Die Ameise plant strukturiert, der Piranha handelt impulsiv.",
    "Hybrid": "Ameise und Hybrid k√∂nnen in ihrer Methodik auseinandergehen ‚Äì klare Abl√§ufe versus flexible, wechselnde Ans√§tze."
  },
  "Biene": {
    "Hy√§ne": "Biene und Hy√§ne k√∂nnen Spannungen erleben, da die teamorientierte Biene auf Kooperation setzt, w√§hrend die Hy√§ne eher eigenst√§ndig agiert.",
    "Dinosaurier": "Biene und Dinosaurier stehen oft unterschiedlich: Biene arbeitet f√ºrs Team, Dinosaurier agiert pragmatisch."
  },
  "Cham√§leon": {
    "Eule": "Cham√§leon und Eule k√∂nnen in ihrer Herangehensweise kollidieren ‚Äì das Cham√§leon √§ndert oft den Kurs, die Eule sucht klare, logische Linien.",
    "Eiche": "Cham√§leon und Eiche haben unterschiedliche Erwartungen: Wandel versus Best√§ndigkeit."
  },
  "Hund": {
    "Katze": "Hund und Katze k√∂nnen unterschiedliche Bed√ºrfnisse haben ‚Äì der Hund sucht N√§he, die Katze bevorzugt Unabh√§ngigkeit.",
    "Parasit": "Hund und Parasit unterscheiden sich darin, wie offen sie agieren ‚Äì der Hund ist direkt, der Parasit eher taktisch zur√ºckhaltend."
  },
  "Katze": {
    "Hund": "Auch wenn Hund und Katze eng beieinander liegen, k√∂nnen Konflikte entstehen, wenn der Wunsch nach N√§he (Hund) auf das Bed√ºrfnis nach Distanz (Katze) trifft.",
    "Gibbon": "Katze und Gibbon k√∂nnen Spannungen haben, da die ruhige Katze sich nicht immer in das kommunikative Temperament des Gibbons einf√ºgt."
  },
  "Gibbon": {
    "Yak": "Gibbon und Yak haben unterschiedliche Kommunikationsstile ‚Äì Gibbon ist sehr offen, w√§hrend Yak auf Stabilit√§t und Ruhe setzt.",
    "Parasit": "Gibbon und Parasit k√∂nnen sich uneinig sein, da der offene Gibbon direktere Gespr√§che bevorzugt, der Parasit subtiler agiert."
  },
  "Hy√§ne": {
    "Einhorn": "Hy√§ne und Einhorn unterscheiden sich deutlich: Hy√§ne ist kontrollierend und zielstrebig, w√§hrend Einhorn idealistisch und tr√§umerisch agiert.",
    "Biene": "Hy√§ne und Biene k√∂nnen Spannungen erleben, da die zielorientierte Hy√§ne eher eigenst√§ndig agiert, die Biene aber auf Teamarbeit setzt."
  },
  "Insekt (n√ºtzlich)": {
    "Parasit": "Das n√ºtzliche Insekt und der Parasit haben unterschiedliche Priorit√§ten ‚Äì Unterst√ºtzung versus taktisches Verhalten.",
    "Klapperschlange": "Insekt (n√ºtzlich) und Klapperschlange gehen unterschiedlich vor: Kooperative Ans√§tze versus kritische Impulse."
  },
  "Insekt (l√§stig)": {
    "Kind": "Insekt (l√§stig) und Kind k√∂nnen aufeinanderprallen, da das unberechenbare Insekt das emotionale Kind √ºberfordern kann.",
    "Hund": "Insekt (l√§stig) provoziert, w√§hrend der Hund auf Harmonie bedacht ist ‚Äì das f√ºhrt zu Spannungen."
  },
  "Schakal": {
    "Wal": "Schakal und Wal k√∂nnen unterschiedliche Schwerpunkte haben ‚Äì taktisches Vorgehen versus emotionale Tiefe.",
    "Kind": "Schakal und Kind haben oft unterschiedliche Priorit√§ten: Strukturiertes Handeln versus impulsives Verhalten."
  },
  "L√∂we": {
    "Maus": "L√∂we und Maus stehen sich oft gegen√ºber: Der dominante L√∂we agiert energisch, w√§hrend die vorsichtige Maus sich eher zur√ºckzieht.",
    "Eule": "L√∂we und Eule k√∂nnen in ihrem Tempo auseinandergehen ‚Äì schnelle Entscheidungen versus analytische √úberlegungen."
  },
  "Maus": {
    "Hy√§ne": "Maus und Hy√§ne k√∂nnen Spannungen erzeugen, da die ruhige Maus Stabilit√§t sucht, w√§hrend Hy√§ne kraftvoll und fordernd agiert.",
    "L√∂we": "Maus und L√∂we zeigen unterschiedliche Dynamiken: Vorsicht versus dominante Pr√§senz."
  },
  "Parasit": {
    "Wal": "Parasit und Wal haben unterschiedliche Ans√§tze: W√§hrend Wal auf Klarheit und Tiefe setzt, wirkt Parasit oft diffus.",
    "Gibbon": "Parasit und Gibbon bewegen sich in unterschiedlichen Kommunikationswelten ‚Äì subtil versus offen."
  },
  "Wal": {
    "Schakal": "Wal und Schakal k√∂nnen Spannungen haben, da Wal auf emotionale Stabilit√§t setzt, w√§hrend Schakal taktisch vorgeht.",
    "Kind": "Wal und Kind unterscheiden sich: Der Wal sucht Ruhe, das Kind bringt lebhafte, emotionale Impulse ein."
  },
  "Dinosaurier": {
    "Einhorn": "Dinosaurier und Einhorn haben unterschiedliche Herangehensweisen: Sicherheit versus idealistische Visionen.",
    "Cham√§leon": "Dinosaurier und Cham√§leon k√∂nnen in ihren Ans√§tzen kollidieren ‚Äì Best√§ndigkeit versus Wandel."
  },
  "Einhorn": {
    "Hy√§ne": "Einhorn und Hy√§ne zeigen unterschiedliche Temperamente ‚Äì das Einhorn lebt in Visionen, w√§hrend Hy√§ne zielstrebig agiert.",
    "Klapperschlange": "Einhorn und Klapperschlange k√∂nnen in ihrer Herangehensweise auseinandergehen ‚Äì Harmonie versus direkte Impulse."
  },
  "Eiche": {
    "Cham√§leon": "Eiche und Cham√§leon k√∂nnen aufeinanderprallen, da Eiche auf Best√§ndigkeit setzt und Cham√§leon h√§ufig flexibel agiert.",
    "Piranha": "Eiche und Piranha haben unterschiedliche Zug√§nge ‚Äì √ºberlegte Planung versus impulsives Handeln."
  },
  "Eule": {
    "Hy√§ne": "Eule und Hy√§ne k√∂nnen Spannungen haben, da die ruhige Eule tiefgr√ºndige Analysen bevorzugt, w√§hrend Hy√§ne schneller agiert.",
    "Kind": "Eule und Kind unterscheiden sich: Eule w√§gt sorgf√§ltig ab, das Kind handelt impulsiv."
  },
  "Klapperschlange": {
    "Wal": "Klapperschlange und Wal k√∂nnen aufeinanderprallen, da die direkte Klapperschlange oft herausfordernd wirkt und der Wal Sicherheit sucht.",
    "Kind": "Klapperschlange und Kind stehen in Kontrast ‚Äì strukturierte Herangehensweise versus spontane Reaktionen."
  },
  "Faultier": {
    "Adler": "Faultier und Adler haben unterschiedliche Dynamiken ‚Äì Faultier arbeitet in Ruhe, Adler strebt nach H√∂herem.",
    "Piranha": "Faultier und Piranha arbeiten in verschiedenen Tempi ‚Äì was zu Spannungen f√ºhren kann."
  },
  "Geier": {
    "Cham√§leon": "Geier und Cham√§leon k√∂nnen in ihrer Planung auseinandergehen ‚Äì strukturierte Ans√§tze versus wechselnde Strategien.",
    "Kind": "Geier und Kind bewegen sich in unterschiedlichen Zeiten ‚Äì vorausschauend versus im Hier und Jetzt."
  },
  "Piranha": {
    "Eule": "Piranha und Eule k√∂nnen Spannungen erzeugen, da Piranha schnelle Entscheidungen trifft, w√§hrend die Eule erst analysiert.",
    "Faultier": "Piranha und Faultier arbeiten in unterschiedlichen Tempi ‚Äì was zu unpassenden Dynamiken f√ºhrt."
  },
  "Kind": {
    "Adler": "Kind und Adler k√∂nnen in ihrer Ausrichtung auseinandergehen ‚Äì impulsives Entdecken versus strukturierte Planung.",
    "Geier": "Kind und Geier haben unterschiedliche Priorit√§ten ‚Äì spontan versus langfristig denkend."
  },
  "Yak": {
    "Piranha": "Yak ist bedacht ‚Äì Piranha handelt impulsiv. Diese unterschiedliche Herangehensweise kann zu Spannung f√ºhren.",
    "Kind": "Yak sch√§tzt Stabilit√§t, w√§hrend das Kind unberechenbar agiert ‚Äì das erfordert Verst√§ndnis."
  },
  "Einhorn": {
    "Hy√§ne": "Einhorn und Hy√§ne prallen in ihren Ans√§tzen aufeinander ‚Äì idealistische Visionen versus n√ºchterne Zielorientierung.",
    "Schakal": "Einhorn und Schakal haben unterschiedliche Herangehensweisen ‚Äì vertr√§umt versus kontrollierend."
  },
  "Hybrid": {
    "Ameise": "Hybrid und Ameise unterscheiden sich in ihrer Methodik ‚Äì flexibles Denken versus klare Ordnung.",
    "Yak": "Hybrid und Yak haben unterschiedliche Schwerpunkte ‚Äì unkonventionelle Ans√§tze versus best√§ndige Ausdauer."
  }
};

  
// =====================================================
// 4) SKALA (0‚Äì4)
// =====================================================
var skalenWerte = [
  { value: 0, label: "0" },
  { value: 1, label: "1" },
  { value: 2, label: "2" },
  { value: 3, label: "3" },
  { value: 4, label: "4" }
];

// =====================================================
// 5) FORMULAR GENERIEREN
// =====================================================
var formElem = document.getElementById("fragebogen");
for (var i = 0; i < questions.length; i++) {
  var q = questions[i];
  var box = document.createElement("div");
  box.className = "frage-box";
  box.innerHTML = "<h2>" + q.frage + "</h2>";

  var answerKeys = Object.keys(q.answers);
  for (var j = 0; j < answerKeys.length; j++) {
    var letter = answerKeys[j];
    var ans = q.answers[letter];

    var ansDiv = document.createElement("div");
    ansDiv.className = "skala-antwort";

    var radiosHTML = "";
    for (var k = 0; k < skalenWerte.length; k++) {
      radiosHTML +=
        '<label>' +
          '<input type="radio" ' +
            'name="frage' + i + '_' + ans.code + '" ' +
            'value="' + skalenWerte[k].value + '" ' +
            'required>' +
          skalenWerte[k].label +
        '</label>';
    }

    ansDiv.innerHTML =
      "<p><strong>" + letter + ":</strong> " + ans.text + "</p>" +
      radiosHTML;
    box.appendChild(ansDiv);
  }
  formElem.appendChild(box);
}

// =====================================================
// 6) AUSWERTUNG (Haupt-/Nebenprofile, Konflikte, Erkl√§rung, Reflektion)
// =====================================================
formElem.addEventListener("submit", function(evt) {
  evt.preventDefault();
  var formData = new FormData(formElem);
  var tierCounts = {};

  // 6a) Punkte z√§hlen
  for (var i = 0; i < questions.length; i++) {
    var q = questions[i];
    var answerKeys = Object.keys(q.answers);

    for (var j = 0; j < answerKeys.length; j++) {
      var letter = answerKeys[j];
      var ans = q.answers[letter];
      var fieldName = "frage" + i + "_" + ans.code;
      var valStr = formData.get(fieldName);
      var valNum = parseInt(valStr, 10) || 0;

      // Kombinierte Zuordnung (C1‚ÄìC4)
      if (comboMapping[ans.code]) {
        var tierList = comboMapping[ans.code];
        var anteil = valNum / tierList.length;

        tierList.forEach(function(tier) {
          tierCounts[tier] = (tierCounts[tier] || 0) + anteil;

          if (valNum >= 3) {
            var gegner = gegenspieler[tier];
            if (gegner) {
              tierCounts[gegner] = (tierCounts[gegner] || 0) - 1;
            }
          }
        });
      } 
      // Einfache Tier-Zuordnung
      else {
        var singleTier = codeToTier[ans.code];
        tierCounts[singleTier] = (tierCounts[singleTier] || 0) + valNum;

        if (valNum >= 3) {
          var gegner = gegenspieler[singleTier];
          if (gegner) {
            tierCounts[gegner] = (tierCounts[gegner] || 0) - 1;
          }
        }
      }
    }
  }

  // 6b) Ergebnisanzeige vorbereiten
  var ergebnisElem = document.getElementById("ergebnis");
  ergebnisElem.innerHTML = "<h2>Dein Verhaltens-Mix</h2>";

  // 6c) Sortieren und Top 5 ermitteln
  var sortedTiers = Object.entries(tierCounts).sort((a, b) => b[1] - a[1]);
  var top5 = sortedTiers.slice(0, 5);
  var hauptprofile = top5.slice(0, 3);
  var nebenprofile = top5.slice(3, 5);
  var top5Total = top5.reduce((sum, el) => sum + el[1], 0);
  var top5Names = top5.map(([tierName]) => tierName);

  // 6d) Darstellung mit Mini-Charts
  function renderTierBlock(title, tierList, top5Total) {
    var section = document.createElement("div");
    section.innerHTML = "<h3>" + title + "</h3>";

    tierList.forEach(function([tierName, value]) {
      var prozent = Math.round((value / top5Total) * 100);
      var tierDiv = document.createElement("div");
      tierDiv.className = "tier-block";
      var canvasId = "tierChart_" + tierName.replace(/\s+/g, "_");

      var info = tierTexte[tierName] || {};
      var kurz = info.kurz || "";
      var symbol = info.symbolischF√ºr || "";

      var blockHTML = `
        <strong>${tierName}</strong><br>
        <span>${kurz}</span><br>
        <em>Symbolisch f√ºr: ${symbol}</em><br>
        <em>${prozent}% innerhalb deiner Top 5</em>
        <canvas id="${canvasId}" width="300" height="150"></canvas>
      `;

      // Konflikttext (wenn Gegenspieler ausserhalb Top 5)
      if (tierKonflikte[tierName]) {
        var conflicts = tierKonflikte[tierName];
        var conflictHTML = "<ul style='list-style:none; padding-left:0; margin:8px 0;'>";
        for (var opponent in conflicts) {
          if (!top5Names.includes(opponent)) {
            conflictHTML += `<li><strong>${opponent}</strong>: ${conflicts[opponent]}</li>`;
          }
        }
        conflictHTML += "</ul>";
        if (conflictHTML !== "<ul style='list-style:none; padding-left:0; margin:8px 0;'></ul>") {
          blockHTML += "<div class='tier-conflicts'><strong>Konflikte:</strong>" + conflictHTML + "</div>";
        }
      }

      tierDiv.innerHTML = blockHTML;
      section.appendChild(tierDiv);

      // Chart rendern
      setTimeout(() => {
        new Chart(document.getElementById(canvasId).getContext("2d"), {
          type: 'doughnut',
          data: {
            labels: [tierName, "Andere"],
            datasets: [{
              data: [value, top5Total - value],
              backgroundColor: ["#3498db", "#ecf0f1"]
            }]
          },
          options: {
            responsive: false,
            plugins: {
              legend: { display: false },
              title: { display: false }
            },
            cutout: "70%"
          }
        });
      }, 10);
    });

    ergebnisElem.appendChild(section);
  }

  // 6e) Anzeigen
  renderTierBlock("üß≠ Hauptprofile (Top 3)", hauptprofile, top5Total);
  renderTierBlock("üß© Nebenprofile (Platz 4 & 5)", nebenprofile, top5Total);

  // 6f) Erkl√§rungstext
  var erklaerung = document.createElement("div");
  erklaerung.className = "ergebnis-erklaerung";
  erklaerung.innerHTML = `
    <p>
      Diese √úbersicht zeigt deinen momentanen Verhaltens-Mix anhand von Tiermetaphern.
      Die <strong>Hauptprofile</strong> spiegeln dominante Eigenschaften wider,
      die <strong>Nebenprofile</strong> erg√§nzen sie durch weitere Facetten.
      Die Prozentzahlen basieren auf allen Antworten und verdeutlichen dein pers√∂nliches Gesamtbild.
    </p>
  `;
  ergebnisElem.appendChild(erklaerung);

  // 6g) Reflektion
  var reflekt = document.createElement("div");
  reflekt.className = "ergebnis-erklaerung";
  reflekt.style.marginTop = "20px";
  reflekt.innerHTML = `
    <h3>üîç Was dein Tierprofil dir zeigt ‚Äì und warum es mehr als nur spannend ist</h3>
    <p>
      Dein Ergebnis ist mehr als eine nette Spielerei: <strong>Es ist ein Spiegel deiner aktuellen Verhaltensdynamik</strong>.
      Jedes Tier steht f√ºr bestimmte Denk-, F√ºhl- und Handlungsweisen ‚Äì und <em>der Mix macht dich einzigartig</em>.
    </p>
    <p>
      Vielleicht steckt in dir ein mutiger <strong>L√∂we</strong>, eine strukturierte <strong>Ameise</strong>,
      ein vision√§res <strong>Einhorn</strong> oder ein tiefgr√ºndiger <strong>Wal</strong>?
    </p>
    <p>
      Diese Tierbilder helfen dir, dich selbst mit einem Augenzwinkern und Tiefe zu betrachten ‚Äì 
      <strong>ohne Schubladen, daf√ºr mit Raum zur Reflexion</strong>.
    </p>
    <p>
      Lust, dein Profil gemeinsam mit anderen zu entdecken, zu hinterfragen und weiterzuentwickeln?
      <strong>Dann ist ein Workshop genau das Richtige f√ºr dich!</strong>
    </p>
    <p>
      Denn: <em>Pers√∂nlichkeitsentwicklung darf Spass machen.</em> Erkenntnisse gewinnen wir oft am besten im Austausch.
    </p>
  `;
  ergebnisElem.appendChild(reflekt);
});

// =====================================================
// 7) PDF-Button-Funktion (mehrseitiger Export mit html2pdf.js)
// =====================================================
// Ersetze den alten PDF-Code komplett durch diesen Block.
document.getElementById("pdfButton").addEventListener("click", function () {
  const element = document.getElementById("ergebnis");
  
  const opt = {
    margin:       10,  // Rand in mm
    filename:     'Auswertung.pdf',
    image:        { type: 'jpeg', quality: 0.98 },
    html2canvas:  { scale: 2, useCORS: true, backgroundColor: '#ffffff', willReadFrequently: true },
    jsPDF:        { unit: 'mm', format: 'a4', orientation: 'portrait' },
    pagebreak:    { mode: ['avoid-all', 'css', 'legacy'] }
  };

  // Mit einer kurzen Verz√∂gerung, damit alle Inhalte vollst√§ndig gerendert sind
  setTimeout(() => {
    html2pdf().set(opt).from(element).save();
  }, 2000);
});
</script>

</body>
</html>
